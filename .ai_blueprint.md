# üèóÔ∏è MAD NOTES C++ | ARCHITECTURE BLUEPRINT
> **System:** C++17 | **Framework:** Qt 6.x | **Build:** CMake
> **Rule:** Max 500 lines per file. Strict RAII. No Business Logic in UI Classes.

## 1. M√ìDULOS DEL SISTEMA

### A. Core (L√≥gica de Negocio y Persistencia)
| Archivo | Responsabilidad |
| :--- | :--- |
| `ConfigManager` | Singleton. Carga/Guarda `config.json` y `vault_history.json`. |
| `VaultManager` | Gesti√≥n de sistema de archivos. Escaneo de directorios, operaciones IO seguras. |
| `DocumentArchitect` | "Buffer Dual". Mantiene el `QString m_rawContent`. Convierte HTML<->RTF. |

### B. Editor (Motor de Texto)
| Archivo | Responsabilidad |
| :--- | :--- |
| `SmartTextEdit` | Hereda de `QTextEdit`. Manejo de eventos de Mouse/Teclado. **NO Regex**. |
| `LinkHighlighter` | Hereda de `QSyntaxHighlighter`. Renderizado pasivo de colores. |
| `ResourceHandler` | Sobrecarga de `loadResource`. Manejo de im√°genes locales para evitar iconos rotos. |

### C. UI (Interfaz de Usuario)
| Archivo | Responsabilidad |
| :--- | :--- |
| `MainWindow` | Solo orquestaci√≥n de Widgets. Toolbar y Splitter. Incluye funcionalidad de b√∫squeda con debounce de 500ms. |
| `SearchDialog` | Di√°logo no modal. Worker sin padre para b√∫squedas pesadas. |
| `ThemeEngine` | Generador est√°tico de QSS (Tokyo Night). Centralizaci√≥n de estilos. |

## 2. FLUJO DE DATOS (Data Flow)
1. **Inicio:** `main.cpp` -> `ThemeEngine::apply()` -> `MainWindow`.
2. **Carga:** `VaultManager` lee archivo -> `DocumentArchitect` sanitiza -> `SmartTextEdit::setHtml()`.
3. **Busqueda:** `QLineEdit` captura entrada -> `QTimer` implementa debounce de 500ms -> `triggerFilter()` filtra archivos en `QListWidget`.
4. **Guardado:** `SmartTextEdit::toHtml()` -> `DocumentArchitect` valida -> `VaultManager` escribe a disco (Atomic Save).

## 3. REGLAS DE ORO (Vibe Coding)
- **Buffer Dual:** Nunca guardar lo que muestra la UI directamente sin pasar por `DocumentArchitect`.
- **No Regex en RTF:** Usar `QTextCursor` y `QTextCharFormat`.
- **Threading:** `QThread` workers **sin padre** en el constructor.
- **Debounce:** Implementar timers para operaciones costosas como b√∫squedas en tiempo real.
